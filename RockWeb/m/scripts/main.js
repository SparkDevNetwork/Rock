var EffecktDemos={init:function(){$(window).load(function(){$(".no-transitions").removeClass("no-transitions")}),EffecktDemos.transitionEndEventName=EffecktDemos.transitionEndEventNames[Modernizr.prefixed("transition")],EffecktDemos.animationEndEventName=EffecktDemos.animationEndEventNames[Modernizr.prefixed("animation")]},animationEndEventNames:{WebkitAnimation:"webkitAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd",animation:"animationend"},transitionEndEventNames:{WebkitTransition:"webkitTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}};EffecktDemos.init();var EffecktPageTransitions={fromPage:"",toPage:"",isAnimating:!1,isNextPageEnd:!1,isCurrentPageEnd:!1,transitionInEffect:"",transitionOutEffect:"",isTouchDevice:Modernizr.touch,init:function(){this.initPages(),this.bindUIActions()},initPages:function(){var a=$("[data-effeckt-page]");a.hide(),this.fromPage=a.first().addClass("effeckt-page-active"),this.fromPage.show()},bindUIActions:function(){var a=this,b="click";$(".effeckt-page-transition-button").on(b,function(b){b.preventDefault();var c=$(this).data("effeckt-transition-in"),d=$(this).data("effeckt-transition-out");transitionPage=$(this).data("effeckt-transition-page"),$(this).data("effeckt-needs-perspective")&&$("html").addClass("md-perspective"),a.transitionPage(transitionPage,c,d)})},transitionPage:function(a,b,c){if(this.isAnimating)return!1;this.isAnimating=!0,this.isCurrentPageEnd=!1,this.isNextPageEnd=!1,this.transitionInEffect=b,this.transitionOutEffect=c,this.fromPage=$(".effeckt-page-active"),this.toPage=$('[data-effeckt-page="'+a+'"]'),this.toPage.addClass("effeckt-page-animating"),this.fromPage.addClass("effeckt-page-animating"),this.toPage.show().addClass("effeckt-page-active"),this.toPage.addClass(this.transitionInEffect),this.fromPage.addClass(this.transitionOutEffect);var d=EffecktDemos.animationEndEventName+" "+EffecktDemos.transitionEndEventName,e=this;this.toPage.on(d,function(){e.toPage.off(d),e.isNextPageEnd=!0,e.isCurrentPageEnd&&e.resetTransition()}),this.fromPage.on(d,function(){e.fromPage.off(d),e.isCurrentPageEnd=!0,e.isNextPageEnd&&e.resetTransition()}),$(this.toPage).trigger("page-transition")},resetTransition:function(){this.isAnimating=!1,this.isCurrentPageEnd=!1,this.isNextPageEnd=!1,this.fromPage.removeClass("effeckt-page-animating"),this.fromPage.removeClass("effeckt-page-active"),this.toPage.removeClass("effeckt-page-animating"),this.fromPage.hide(),this.fromPage.removeClass(this.transitionOutEffect),this.toPage.removeClass(this.transitionInEffect),$("html").removeClass("md-perspective")}};EffecktPageTransitions.init();var ccvMapStyles=[{stylers:[{visibility:"simplified"},{saturation:-100}]},{featureType:"road.arterial",elementType:"labels",stylers:[{visibility:"on"},{gamma:3.05}]},{featureType:"poi",stylers:[{visibility:"off"}]},{featureType:"transit",stylers:[{visibility:"off"}]},{featureType:"administrative.country",stylers:[{visibility:"off"}]},{featureType:"administrative.locality",stylers:[{visibility:"off"}]},{featureType:"administrative.neighborhood",stylers:[{visibility:"off"}]},{featureType:"water",stylers:[{visibility:"off"}]},{}],ccvMapType=new google.maps.StyledMapType(ccvMapStyles),markerFile=window.devicePixelRatio>1.5?"http://www.ccvonline.com/Arena/Content/v6/img/maps/marker@2x.png":"http://www.ccvonline.com/Arena/Content/v6/img/maps/marker.png",ccvMarker=new google.maps.MarkerImage(markerFile,null,null,null,new google.maps.Size(30,38)),ccvMarkerShadow=new google.maps.MarkerImage("http://www.ccvonline.com/Arena/Content/v6/img/maps/marker-shadow.png",new google.maps.Size(52,38),new google.maps.Point(0,0),new google.maps.Point(15,38)),ccvMarkerShape={coord:[20,0,22,1,23,2,25,3,26,4,26,5,27,6,28,7,28,8,29,9,29,10,29,11,29,12,29,13,29,14,29,15,29,16,29,17,29,18,29,19,29,20,28,21,28,22,27,23,26,24,26,25,25,26,24,27,23,28,22,29,21,30,21,31,20,32,19,33,18,34,17,35,16,36,15,37,14,37,13,36,12,35,11,34,10,33,9,32,9,31,8,30,7,29,6,28,5,27,4,26,4,25,3,24,2,23,1,22,1,21,1,20,0,19,0,18,0,17,0,16,0,15,0,14,0,13,0,12,0,11,0,10,1,9,1,8,1,7,2,6,3,5,4,4,5,3,6,2,7,1,9,0,20,0],type:"poly"};if("object"==typeof google)var northPhoenix=new google.maps.LatLng(33.6471175794703,-112.14019775390625),centralPhoenix=new google.maps.LatLng(33.446912,-112.07222),southPhoenix=new google.maps.LatLng(33.446912,-111.999114),southTempe=new google.maps.LatLng(33.392076,-111.926008);var campuses=[{id:"1",name:"Peoria",geo:{lat:33.710468,lng:-112.208803}},{id:"5",name:"Surprise",geo:{lat:33.585773,lng:-112.378889}},{id:"6",name:"Scottsdale",geo:{lat:33.658067,lng:-111.889376}},{id:"7",name:"East Valley",geo:{lat:33.390704,lng:-111.617047}},{id:"8",name:"Anthem",geo:{lat:33.846832,lng:-112.137014}},{id:"9",name:"Avondale",geo:{lat:33.4616968,lng:-112.3008445}}],popped="state"in window.history&&null!==window.history.state,initialURL=location.href,CCVMobile={init:function(){this.setStartPage();var a=$("[data-effeckt-page]");this.bindUIActions(a),$(document).ready(function(){CCVMobile.promos("Promo-holder")})},setStartPage:function(){var a=hash.get("campus");a?($(".p-Home").removeClass("effeckt-page-active").addClass("effeckt-page-animating"),$('[data-effeckt-page="page-'+a+'"]').show().addClass("effeckt-page-active"),this.pageIsChanging(a)):this.event("Page View","Home Page")},bindUIActions:function(a){function b(a,b){a.each(function(a,d){var e=$(d),f=e.closest(".p-CampusDetail").attr("data-campus-id");e.click(function(){c.event(b,c.resolveCampusName(f," Campus"))})})}var c=this;$(a).on("page-transition",function(){c.pageIsChanging($(this).attr("data-campus-id"))}),b($(".p-CampusDetail .btn-directions"),"Got Directions"),b($(".p-CampusDetail .Contact .address"),"Got Directions"),b($(".p-CampusDetail .btn-call"),"Phone Call"),b($(".p-CampusDetail .Contact .phone"),"Phone Call"),window.onpopstate=function(a){if(popped||initialURL!==location.href){if(EffecktPageTransitions.isAnimating)return;var b=hash.get("campus"),d="right";void 0==b&&(b=0,d="left");var e=$(".p-Home").hasClass("effeckt-page-active");if(0===b&&e)return;c.changePage(b,d)}else popped=!0}},changePage:function(a,b){if(b="undefined"!=typeof b?b:"left","left"===b)var c="right";else var c="left";var d="page-"+a,e="slide-from-"+b,f="slide-to-"+c;EffecktPageTransitions.transitionPage(d,e,f)},pageIsChanging:function(a){"all"===a?(CCVMobile.drawAllMap(),this.event("Page View","View All Campuses on Map")):a&&"all"!=a&&(CCVMobile.drawSingleMap(a),this.event("Page View",this.resolveCampusName(a," Campus"))),a?hash.add({campus:a}):(hash.remove("campus"),this.event("Page View","Home Page"))},event:function(a,b,c){var d="CCV Mobile Site";if(a&&b&&c)_gaq.push(["_trackEvent",d,a,b,parseInt(c)]);else if(a&&b)_gaq.push(["_trackEvent",d,a,b]);else{if(!a)return;_gaq.push(["_trackEvent",d,a])}},resolveCampusName:function(a,b){for(var c=campuses.length-1;c>=0;c--){var d,e=campuses[c];e.id===a.toString()&&(d=e.name)}return b&&(d+=b),d},geocode:function(a){var b,c=campuses.filter(function(b){return b.id==a})[0],d=c.geo.lat,e=c.geo.lng;return b=new google.maps.LatLng(d,e)},buildInfoWindow:function(a){var b,c=campuses.filter(function(b){return b.id==a})[0];return b="<strong>"+c.name+" Campus</strong>",b+="<br />",b+="<a onclick=\"EffecktPageTransitions.transitionPage('page-"+c.id+"','slide-from-right','slide-to-left')\">More info &rarr;</a>"},drawSingleMap:function(a){var b=campuses.filter(function(b){return b.id==a})[0],c=this.geocode(a),d=$("[data-campus-id="+a+"] .Map")[0],e={zoom:12,center:c,mapTypeId:"CCV",disableDefaultUI:!0};map=new google.maps.Map(d,e),map.mapTypes.set("CCV",ccvMapType);new google.maps.Marker({icon:ccvMarker,shadow:ccvMarkerShadow,shape:ccvMarkerShape,position:c,map:map,title:b.name,animation:google.maps.Animation.DROP})},drawAllMap:function(){var a=[],b=southTempe,c=$("[data-campus-id=all] .Map")[0],d={zoom:8,center:b,mapTypeId:"CCV",disableDefaultUI:!0};map=new google.maps.Map(c,d),map.mapTypes.set("CCV",ccvMapType);for(var e=0;e<campuses.length;e++)a.push(new google.maps.Marker({position:CCVMobile.geocode(campuses[e].id),icon:ccvMarker,shadow:ccvMarkerShadow,shape:ccvMarkerShape,map:map,title:campuses[e].name,campusid:campuses[e].id,animation:google.maps.Animation.DROP}));for(var f=new google.maps.InfoWindow({content:"Loading..."}),e=0;e<campuses.length;e++){var g=a[e];google.maps.event.addListener(g,"click",function(){f.setContent(CCVMobile.buildInfoWindow(this.campusid)),f.open(map,this)})}this.locateUser(map)},locateUser:function(a){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(b){var c=new google.maps.LatLng(b.coords.latitude,b.coords.longitude);new google.maps.Marker({icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:"#00aaff",fillOpacity:1,strokeColor:"#00aaff",strokeOpacity:.75,strokeWeight:"2",scale:4},position:c,map:a})})},promos:function(a){var b=this,c="//ccv.church/api/ContentChannelItems/DataView/123?loadAttributes=true&$orderby=Priority%20asc&$top=1";$.getJSON(c,function(c){var d=function(){return c[0].AttributeValues.ExternalLink.Value.length>0?c[0].AttributeValues.ExternalLink.Value:"//ccv.church/promo?Item="+c[0].Id},e="//ccv.church/GetImage.ashx?guid="+c[0].AttributeValues.Image.Value+"&width=320";$("#"+a).append('<a href="'+d()+'"><img class="Promo-img" src="'+e+'"/></a>'),$(document).ready(function(){window.setTimeout(function(){b.retinifyPromo()},500)})})},retinifyPromo:function(){if(Modernizr.addTest("highresdisplay",function(){if(window.matchMedia){var a=window.matchMedia("only screen and (-moz-min-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen  and (min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx)");if(a&&a.matches)return!0}}),Modernizr.highresdisplay){var a=$(".Promo-img"),b=a.attr("src"),c=b.replace("width=320","width=640");a.attr("src",c)}}};CCVMobile.init();