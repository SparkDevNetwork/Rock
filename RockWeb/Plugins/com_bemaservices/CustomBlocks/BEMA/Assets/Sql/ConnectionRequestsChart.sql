Select CASE GROUPING(IsNull(C.Name, 'No Campus')) WHEN 1 THEN 'Total' ELSE IsNull(C.Name, 'No Campus') END AS 'Campus', count(0) AS [Requests] From ConnectionRequest CR Inner Join ConnectionOpportunity CO On CR.ConnectionOpportunityId = CO.Id Left Join Campus C On CR.CampusId = C.Id Where CR.CreatedDateTime > DateAdd(year, -1 ,getdate()) {% if PageParameter.Campus != null %} AND C.Guid in ('{{PageParameter.Campus | SanitizeSql }}') {% endif %} Group By IsNull(C.Name, 'No Campus') With Rollup Order By Grouping(IsNull(C.Name, 'No Campus')) desc, IsNull(C.Name, 'No Campus') Select CASE GROUPING(IsNull(C.Name, 'No Campus')) WHEN 1 THEN 'Total' ELSE IsNull(C.Name, 'No Campus') END AS 'Campus', count(0) AS [Requests] From ConnectionRequest CR Inner Join ConnectionOpportunity CO On CR.ConnectionOpportunityId = CO.Id Left Join Campus C On CR.CampusId = C.Id Where CR.CreatedDateTime > DateAdd(year, -1 ,getdate()) And CR.ConnectionState In (0,2) {% if PageParameter.Campus != null %} AND C.Guid in ('{{PageParameter.Campus | SanitizeSql }}') {% endif %} Group By IsNull(C.Name, 'No Campus') With Rollup Order By Grouping(IsNull(C.Name, 'No Campus')) desc, IsNull(C.Name, 'No Campus') Select CASE GROUPING(IsNull(C.Name, 'No Campus')) WHEN 1 THEN 'Total' ELSE IsNull(C.Name, 'No Campus') END AS 'Campus', count(0) AS [Requests] From ConnectionRequest CR Inner Join ConnectionOpportunity CO On CR.ConnectionOpportunityId = CO.Id Left Join Campus C On CR.CampusId = C.Id Where CR.CreatedDateTime > DateAdd(year, -1 ,getdate()) And CR.ConnectionStatusId = 2 {% if PageParameter.Campus != null %} AND C.Guid in ('{{PageParameter.Campus | SanitizeSql}}') {% endif %} Group By IsNull(C.Name, 'No Campus') With Rollup Order By Grouping(IsNull(C.Name, 'No Campus')) desc, IsNull(C.Name, 'No Campus') Select CASE GROUPING(IsNull(C.Name, 'No Campus')) WHEN 1 THEN 'Total' ELSE IsNull(C.Name, 'No Campus') END AS 'Campus', AVG(DATEDIFF(day, CR.CreatedDateTime, CR.ModifiedDateTime)) AS [Average] From ConnectionRequest CR Inner Join ConnectionOpportunity CO On CR.ConnectionOpportunityId = CO.Id Left Join Campus C On CR.CampusId = C.Id Where CR.CreatedDateTime > DateAdd(year, -1 ,getdate()) And CR.ConnectionState In (1,3) {% if PageParameter.Campus != null %} AND C.Guid in ('{{PageParameter.Campus | SanitizeSql}}') {% endif %} Group By IsNull(C.Name, 'No Campus') With Rollup Order By Grouping(IsNull(C.Name, 'No Campus')) desc, IsNull(C.Name, 'No Campus')
